(function(){"use strict";var e={8424:function(e,t,a){var s=a(3751),l=a(641);const r={id:"app"};function o(e,t,a,s,o,n){const i=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.bF)(i)])}var n={name:"App"},i=a(6262);const u=(0,i.A)(n,[["render",o]]);var c=u,d=a(5220);const k={class:"login-container"},p={class:"container"};function h(e,t,a,r,o,n){return(0,l.uX)(),(0,l.CE)("div",k,[(0,l.Lk)("div",p,[t[9]||(t[9]=(0,l.Lk)("h1",null,"欢迎光临食尚阁",-1)),t[10]||(t[10]=(0,l.Lk)("p",{class:"welcome-message"},"美味等待着您",-1)),(0,l.Lk)("form",{onSubmit:t[3]||(t[3]=(0,s.D$)(((...e)=>n.submitLogin&&n.submitLogin(...e)),["prevent"]))},[t[5]||(t[5]=(0,l.Lk)("label",{for:"role"},"请选择身份：",-1)),(0,l.bo)((0,l.Lk)("select",{id:"role","onUpdate:modelValue":t[0]||(t[0]=e=>o.role=e),required:""},t[4]||(t[4]=[(0,l.Lk)("option",{value:"customer"},"顾客",-1),(0,l.Lk)("option",{value:"admin"},"管理员",-1),(0,l.Lk)("option",{value:"counter"},"前台",-1)]),512),[[s.u1,o.role]]),t[6]||(t[6]=(0,l.Lk)("label",{for:"username"},"用户名：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[1]||(t[1]=e=>o.username=e),required:""},null,512),[[s.Jo,o.username]]),t[7]||(t[7]=(0,l.Lk)("label",{for:"password"},"密码：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>o.password=e),required:""},null,512),[[s.Jo,o.password]]),t[8]||(t[8]=(0,l.Lk)("div",{class:"button-container"},[(0,l.Lk)("button",{type:"submit"},"登录")],-1))],32),t[11]||(t[11]=(0,l.Lk)("div",{class:"button-container"},[(0,l.Lk)("a",{href:"/register",style:{color:"black"}},"没有密码，点击注册")],-1))])])}a(4114);var m={data(){return{username:"",password:"",role:"customer"}},methods:{async submitLogin(){const{username:e,password:t,role:a}=this;if("admin"===a)"admin"===e&&"123456"===t?(alert("管理员登录成功"),localStorage.setItem("role","admin"),this.$router.push("/admin")):alert("管理员账号或密码错误");else if("counter"===a)"counter"===e&&"123456"===t?(alert("前台登录成功"),localStorage.setItem("role","counter"),this.$router.push("/counter")):alert("前台账号或密码错误");else try{const a=await fetch("http://localhost:8080/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),s=await a.json();a.ok?(alert("顾客登录成功"),localStorage.setItem("username",e),this.$router.push("/menu")):alert("登录失败："+s.message)}catch(s){alert("登录时发生错误: "+s.message)}}}};const v=(0,i.A)(m,[["render",h]]);var L=v,g=a(953),b=a(4335);const y={class:"container"};var f={__name:"RegisterPage",setup(e){const t=(0,g.KR)(""),a=(0,g.KR)(""),r=(0,d.rd)(),o=async()=>{try{await b.A.post("http://localhost:8080/api/register",{username:t.value,password:a.value}),alert("注册成功！"),r.push("/login")}catch(e){alert("注册失败: "+(e.response?.data?.message||"服务器错误"))}};return(e,r)=>{const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",y,[r[7]||(r[7]=(0,l.Lk)("div",{class:"header"},[(0,l.Lk)("h1",null,"注册")],-1)),(0,l.Lk)("form",{onSubmit:(0,s.D$)(o,["prevent"])},[r[2]||(r[2]=(0,l.Lk)("label",{for:"username"},"用户名：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=e=>t.value=e),id:"username"},null,512),[[s.Jo,t.value]]),r[3]||(r[3]=(0,l.Lk)("label",{for:"password"},"密码：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"password","onUpdate:modelValue":r[1]||(r[1]=e=>a.value=e),id:"password"},null,512),[[s.Jo,a.value]]),r[4]||(r[4]=(0,l.Lk)("br",null,null,-1)),r[5]||(r[5]=(0,l.Lk)("button",{type:"submit"},"注册",-1))],32),(0,l.Lk)("p",null,[(0,l.bF)(n,{to:"/login",class:"login-link"},{default:(0,l.k6)((()=>r[6]||(r[6]=[(0,l.eW)("返回登录页面")]))),_:1})])])}}};const _=f;var C=_,I=a(33);const P={class:"container"},W={class:"content"},F={class:"sidebar"},D={class:"menu-container"},w=["src","alt"],E=["onClick"],X=["onClick"],A={class:"cart"},S={id:"shopping-cart"};function T(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",P,[t[9]||(t[9]=(0,l.Lk)("div",{class:"header"},[(0,l.Lk)("h1",null,"食尚阁 - 点菜系统")],-1)),(0,l.Lk)("div",W,[(0,l.Lk)("div",F,[t[7]||(t[7]=(0,l.Lk)("h2",null,"选择",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/my-account"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)("我的/会员")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/ordertable"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/my_ordertable"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("已预定的餐桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/package"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/buffet"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("自助餐")]))),_:1})])])]),(0,l.Lk)("div",D,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.dishes,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"dish"},[(0,l.Lk)("img",{src:`/img/${encodeURIComponent(e.dishName)}.jpg`,alt:e.dishName},null,8,w),(0,l.Lk)("h3",null,(0,I.v_)(e.dishName),1),(0,l.Lk)("p",null,"价格: ￥"+(0,I.v_)(e.dishPrice),1),(0,l.Lk)("span",{class:"add-to-cart",onClick:t=>o.addToCart(e.dishName,e.dishPrice)},"+",8,E),(0,l.Lk)("span",{class:"remove-from-cart",onClick:t=>o.removeFromCart(e.dishName,e.dishPrice)},"-",8,X)])))),128))])]),(0,l.Lk)("div",A,[t[8]||(t[8]=(0,l.Lk)("h2",null,"购物车",-1)),(0,l.Lk)("div",S,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.cart,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.name},[(0,l.Lk)("p",null,(0,I.v_)(e.name)+" - ￥"+(0,I.v_)(e.price),1)])))),128)),(0,l.Lk)("div",null,"Total Price: ￥"+(0,I.v_)(r.totalPrice),1)]),(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.checkout&&o.checkout(...e))},"提交堂食订单"),(0,l.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.checkoutDelivery&&o.checkoutDelivery(...e)),class:"checkout-button"},"提交外卖订单")])])}a(8111),a(7588),a(1701);var O={data(){return{dishes:[],cart:[],totalPrice:0}},created(){this.loadMenu()},methods:{async loadMenu(){try{const e=await b.A.get("http://localhost:8080/api/menu");this.dishes=e.data}catch(e){console.error("Error loading menu:",e)}},addToCart(e,t){this.cart.push({name:e,price:t}),this.totalPrice+=t,this.renderCart(),alert(e+"已加入购物车！")},removeFromCart(e,t){const a=this.cart.findIndex((t=>t.name===e));-1!==a&&(this.cart.splice(a,1),this.totalPrice-=t,this.renderCart(),alert(e+"已从购物车移除！"))},renderCart(){},async checkout(){const e={username:localStorage.getItem("username"),totalPrice:this.totalPrice.toFixed(2),items:this.cart.map((e=>e.name))};localStorage.setItem("orderData",JSON.stringify(e)),this.$router.push("/checkout")},checkoutDelivery(){const e={username:localStorage.getItem("username"),totalPrice:this.totalPrice.toFixed(2),dishList:this.cart.map((e=>({name:e.name,price:e.price})))};localStorage.setItem("deliveryOrderData",JSON.stringify(e)),this.$router.push("/delivery-checkout")},submitOrder(e){const t=this.createForm(e);this.cart.forEach((e=>{this.addItemToForm(t,e.name,e.price)})),this.addTotalPriceToForm(t),this.submitForm(t)},createForm(e){const t=document.createElement("form");return t.setAttribute("method","post"),t.setAttribute("action",e),t},addItemToForm(e,t,a){const s=this.createHiddenInput("item[]",t),l=this.createHiddenInput("price[]",a);e.appendChild(s),e.appendChild(l)},addTotalPriceToForm(e){const t=this.createHiddenInput("totalPrice",this.totalPrice);e.appendChild(t)},createHiddenInput(e,t){const a=document.createElement("input");return a.setAttribute("type","hidden"),a.setAttribute("name",e),a.setAttribute("value",t),a},submitForm(e){document.body.appendChild(e),e.submit()}}};const $=(0,i.A)(O,[["render",T],["__scopeId","data-v-9771bc2a"]]);var M=$;const N={class:"container"},V={class:"content"},U={class:"menu-container"},x={class:"dish"},J=["onClick"],K=["src","alt"],R={class:"shopping-cart"},q=["onClick"];function Q(e,t,a,s,r,o){return(0,l.uX)(),(0,l.CE)("div",N,[t[3]||(t[3]=(0,l.Lk)("div",{class:"header"},[(0,l.Lk)("h1",null,"食尚阁 - 套餐")],-1)),(0,l.Lk)("div",V,[t[1]||(t[1]=(0,l.Fv)('<div class="sidebar" data-v-978d36c2><h2 data-v-978d36c2>选择</h2><ul data-v-978d36c2><li data-v-978d36c2><a href="/my-account" data-v-978d36c2>我的/会员</a></li><li data-v-978d36c2><a href="/ordertable" data-v-978d36c2>订桌</a></li><li data-v-978d36c2><a href="/menu" data-v-978d36c2>菜单</a></li><li data-v-978d36c2><a href="/buffet" data-v-978d36c2>自助餐</a></li></ul></div>',1)),(0,l.Lk)("div",U,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.packages,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.packageId,class:"scrollable-menu-container"},[(0,l.Lk)("div",x,[(0,l.Lk)("h3",null,[(0,l.eW)((0,I.v_)(e.packageName)+" ",1),(0,l.Lk)("span",{class:"add-to-cart",onClick:t=>o.addToCart(e)},"+",8,J)]),(0,l.Lk)("p",null,"价格: "+(0,I.v_)(e.packagePrice),1),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.dishList,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id},(0,I.v_)(e.dishName)+" - ￥"+(0,I.v_)(e.dishPrice),1)))),128))]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.dishList,(e=>((0,l.uX)(),(0,l.CE)("img",{key:e.id,src:"/img/"+e.dishName+".jpg",alt:e.dishName},null,8,K)))),128))])])))),128))])]),(0,l.Lk)("div",R,[t[2]||(t[2]=(0,l.Lk)("h2",null,"购物车",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.cart,((e,t)=>((0,l.uX)(),(0,l.CE)("li",{key:t},[(0,l.eW)((0,I.v_)(e.packageName)+" - ￥"+(0,I.v_)(e.packagePrice)+" ",1),(0,l.Lk)("span",{class:"remove-from-cart",onClick:e=>o.removeFromCart(t)},"-",8,q)])))),128))]),(0,l.Lk)("button",{class:"checkout-btn",onClick:t[0]||(t[0]=(...e)=>o.checkout&&o.checkout(...e))},"结账")])])}a(8237);var j={name:"PackagePage",data(){return{packages:[],cart:[]}},mounted(){this.fetchPackages()},methods:{fetchPackages(){b.A.get("/api/packages").then((e=>{this.packages=e.data}))},addToCart(e){this.cart.push(e),alert("已成功将套餐添加到购物车！")},removeFromCart(e){confirm("确认要删除吗？")&&this.cart.splice(e,1)},checkout(){const e=localStorage.getItem("username"),t=this.cart.map((e=>e.packageName)),a=this.cart.map((e=>e.packagePrice)),s=a.reduce(((e,t)=>e+t),0),l={username:e,items:t,prices:a,totalPrice:s,cartDetails:this.cart};localStorage.setItem("orderData",JSON.stringify(l)),this.$router.push("/checkout")}}};const H=(0,i.A)(j,[["render",Q],["__scopeId","data-v-978d36c2"]]);var B=H;const z={class:"container"},Y={class:"content"},G={class:"outer-container"},Z={class:"menu-container"},ee=["src","alt"],te={class:"content"},ae={class:"outer-container"},se={class:"menu-container"},le=["src","alt"],re={class:"checkout-section"},oe={class:"diners-selection"};function ne(e,t,a,r,o,n){return(0,l.uX)(),(0,l.CE)("div",z,[t[11]||(t[11]=(0,l.Lk)("div",{class:"header"},[(0,l.Lk)("h1",null,"食尚阁 - 下午茶自助")],-1)),(0,l.Lk)("div",Y,[t[5]||(t[5]=(0,l.Fv)('<div class="sidebar" data-v-0dc4cf7d><h2 data-v-0dc4cf7d>选择</h2><ul data-v-0dc4cf7d><li data-v-0dc4cf7d><a href="/my-account" data-v-0dc4cf7d>我的/会员</a></li><li data-v-0dc4cf7d><a href="/ordertable" data-v-0dc4cf7d>订桌</a></li><li data-v-0dc4cf7d><a href="/package" data-v-0dc4cf7d>套餐</a></li><li data-v-0dc4cf7d><a href="/menu" data-v-0dc4cf7d>菜单</a></li></ul></div>',1)),(0,l.Lk)("div",G,[t[4]||(t[4]=(0,l.Lk)("h2",null,"甜品",-1)),(0,l.Lk)("div",Z,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.dessertList,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"dish",key:e.id},[(0,l.Lk)("img",{src:`/img/${e.itemName}.jpg`,alt:e.itemName},null,8,ee),(0,l.Lk)("h3",null,(0,I.v_)(e.itemName),1)])))),128))])])]),(0,l.Lk)("div",te,[(0,l.Lk)("div",ae,[t[6]||(t[6]=(0,l.Lk)("h2",null,"酒水",-1)),(0,l.Lk)("div",se,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.drinkList,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"dish",key:e.id},[(0,l.Lk)("img",{src:`/img/${e.itemName}.jpg`,alt:e.itemName},null,8,le),(0,l.Lk)("h3",null,(0,I.v_)(e.itemName),1)])))),128))])])]),(0,l.Lk)("div",re,[t[10]||(t[10]=(0,l.Lk)("h2",null,"选择用餐人数：(50￥一位，儿童，老人半价)",-1)),(0,l.Lk)("div",oe,[t[7]||(t[7]=(0,l.Lk)("label",null,"成人（12岁以上）：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>o.numAdults=e),min:"0"},null,512),[[s.Jo,o.numAdults,void 0,{number:!0}]]),t[8]||(t[8]=(0,l.Lk)("label",null,"儿童(12岁以下)：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>o.numChildren=e),min:"0"},null,512),[[s.Jo,o.numChildren,void 0,{number:!0}]]),t[9]||(t[9]=(0,l.Lk)("label",null,"老人（60岁以上）：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>o.numSeniors=e),min:"0"},null,512),[[s.Jo,o.numSeniors,void 0,{number:!0}]])]),(0,l.Lk)("button",{class:"checkout-btn",onClick:t[3]||(t[3]=(...e)=>n.checkout&&n.checkout(...e))},"结账")])])}var ie={name:"AfternoonTea",data(){return{dessertList:[],drinkList:[],numAdults:0,numChildren:0,numSeniors:0}},mounted(){this.fetchMenuItems()},methods:{fetchMenuItems(){b.A.get("/api/afternoon-tea/desserts").then((e=>this.dessertList=e.data)).catch((e=>console.error("获取甜品失败:",e))),b.A.get("/api/afternoon-tea/drinks").then((e=>this.drinkList=e.data)).catch((e=>console.error("获取酒水失败:",e)))},checkout(){const e=localStorage.getItem("username"),t=50*this.numAdults+25*this.numChildren+25*this.numSeniors,a={username:e,items:["afternoon tea"],prices:[t],totalPrice:t,cartDetails:{numAdults:this.numAdults,numChildren:this.numChildren,numSeniors:this.numSeniors}};localStorage.setItem("orderData",JSON.stringify(a)),this.$router.push("/checkout")}}};const ue=(0,i.A)(ie,[["render",ne],["__scopeId","data-v-0dc4cf7d"]]);var ce=ue;const de={class:"container"},ke={class:"order-form"},pe={class:"table-type-input"},he=["min"],me={key:0,class:"success-message"},ve={key:1,class:"error-message"};function Le(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",de,[(0,l.Lk)("div",ke,[t[14]||(t[14]=(0,l.Lk)("h2",null,"预定餐桌",-1)),t[15]||(t[15]=(0,l.Lk)("div",{class:"table-images"},[(0,l.Lk)("img",{src:"/img/table.jpg",alt:"普通餐桌",class:"table-image"}),(0,l.Lk)("img",{src:"/img/boxes.jpg",alt:"包厢",class:"table-image"})],-1)),(0,l.Lk)("form",{onSubmit:t[4]||(t[4]=(0,s.D$)(((...e)=>n.submitReservation&&n.submitReservation(...e)),["prevent"]))},[t[7]||(t[7]=(0,l.Lk)("label",{class:"table-type-label"},"请选择餐桌类型：",-1)),(0,l.Lk)("div",pe,[(0,l.bo)((0,l.Lk)("input",{type:"radio",value:"normal","onUpdate:modelValue":t[0]||(t[0]=e=>o.form.tableType=e)},null,512),[[s.XL,o.form.tableType]]),t[5]||(t[5]=(0,l.eW)(" 普通桌位 ")),(0,l.bo)((0,l.Lk)("input",{type:"radio",value:"private","onUpdate:modelValue":t[1]||(t[1]=e=>o.form.tableType=e)},null,512),[[s.XL,o.form.tableType]]),t[6]||(t[6]=(0,l.eW)(" 包厢 "))]),t[8]||(t[8]=(0,l.Lk)("label",{class:"table-size-label",for:"numOfPeople"},"用餐人数：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number",id:"numOfPeople","onUpdate:modelValue":t[2]||(t[2]=e=>o.form.numOfPeople=e),class:"table-size-input",required:""},null,512),[[s.Jo,o.form.numOfPeople]]),t[9]||(t[9]=(0,l.Lk)("br",null,null,-1)),t[10]||(t[10]=(0,l.Lk)("label",{class:"table-size-label",for:"reservationTime"},"用餐时间：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"reservationTime","onUpdate:modelValue":t[3]||(t[3]=e=>o.form.reservationTime=e),min:o.minDateTime,class:"table-size-input",required:""},null,8,he),[[s.Jo,o.form.reservationTime]]),t[11]||(t[11]=(0,l.Lk)("br",null,null,-1)),t[12]||(t[12]=(0,l.Lk)("button",{type:"submit"},"确认预定",-1))],32),o.successMessage?((0,l.uX)(),(0,l.CE)("p",me,(0,I.v_)(o.successMessage),1)):(0,l.Q3)("",!0),o.errorMessage?((0,l.uX)(),(0,l.CE)("p",ve,(0,I.v_)(o.errorMessage),1)):(0,l.Q3)("",!0),o.successMessage?((0,l.uX)(),(0,l.Wv)(i,{key:2,to:"/menu",class:"redirect-button"},{default:(0,l.k6)((()=>t[13]||(t[13]=[(0,l.eW)(" 返回菜单 ")]))),_:1})):(0,l.Q3)("",!0)])])}var ge={name:"ReservationPage",data(){return{form:{tableType:"normal",numOfPeople:"",reservationTime:"",username:localStorage.getItem("username")||""},minDateTime:"",successMessage:"",errorMessage:""}},mounted(){const e=new Date,t=e.toISOString().slice(0,16);this.minDateTime=t},methods:{async submitReservation(){this.successMessage="",this.errorMessage="";try{const e=await b.A.post("http://localhost:8080/api/reserve",this.form);"success"===e.data.status?this.successMessage=`预定成功！您的桌号为：${e.data.tableNumber}`:this.errorMessage=e.data.message}catch(e){this.errorMessage="请求失败，请稍后重试"}}}};const be=(0,i.A)(ge,[["render",Le],["__scopeId","data-v-158da011"]]);var ye=be;const fe={class:"container"},_e={class:"order-table"},Ce={key:0},Ie=["onClick"],Pe={key:1,class:"no-reservation-box"},We={key:2,class:"success-message"},Fe={key:3,class:"error-message"};function De(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",fe,[(0,l.Lk)("div",_e,[t[5]||(t[5]=(0,l.Lk)("h2",null,"我的预定餐桌",-1)),r.reservations.length>0?((0,l.uX)(),(0,l.CE)("table",Ce,[t[0]||(t[0]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"桌位号"),(0,l.Lk)("th",null,"预定时间"),(0,l.Lk)("th",null,"预定ID"),(0,l.Lk)("th",null,"操作")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.reservations,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.reservationId},[(0,l.Lk)("td",null,(0,I.v_)(e.tableNumber),1),(0,l.Lk)("td",null,(0,I.v_)(e.reservationTime),1),(0,l.Lk)("td",null,(0,I.v_)(e.reservationId),1),(0,l.Lk)("td",null,[(0,l.Lk)("button",{class:"cancel-button",onClick:t=>o.cancelReservation(e.reservationId)},"取消预约",8,Ie)])])))),128))])])):((0,l.uX)(),(0,l.CE)("div",Pe,[t[2]||(t[2]=(0,l.Lk)("div",{class:"no-reservation-icon"},"🍽️",-1)),t[3]||(t[3]=(0,l.Lk)("div",{class:"no-reservation-text"},"您目前还没有预定餐桌",-1)),t[4]||(t[4]=(0,l.Lk)("div",{class:"no-reservation-subtext"},"看起来您还未用餐，赶快预定一张专属座位吧！",-1)),(0,l.bF)(n,{to:"/menu",class:"go-to-menu"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)("👉 返回菜单")]))),_:1})])),r.successMessage?((0,l.uX)(),(0,l.CE)("p",We,(0,I.v_)(r.successMessage),1)):(0,l.Q3)("",!0),r.errorMessage?((0,l.uX)(),(0,l.CE)("p",Fe,(0,I.v_)(r.errorMessage),1)):(0,l.Q3)("",!0)])])}a(2489);var we={name:"MyReservationPage",data(){return{reservations:[],successMessage:"",errorMessage:""}},mounted(){const e=localStorage.getItem("username");e?fetch(`http://localhost:8080/api/my-reservation?username=${e}`).then((e=>e.json())).then((e=>{this.reservations=e})).catch((e=>{this.errorMessage="加载失败："+e.message})):this.$router.push("/login")},methods:{async cancelReservation(e){this.successMessage="",this.errorMessage="";try{const t=await fetch("http://localhost:8080/api/cancel-reservation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reservationId:e})}),a=await t.json();"success"===a.status?(this.successMessage=a.message,this.reservations=this.reservations.filter((t=>t.reservationId!==e))):this.errorMessage=a.message||"取消失败"}catch(t){this.errorMessage="请求错误："+t.message}}}};const Ee=(0,i.A)(we,[["render",De],["__scopeId","data-v-40a3ef58"]]);var Xe=Ee;const Ae={class:"container"},Se={class:"checkout-form"},Te={class:"selected-items"},Oe={key:0},$e={key:1},Me={class:"total-price"},Ne={class:"coupon-select"},Ve=["value"];function Ue(e,t,a,r,o,n){return(0,l.uX)(),(0,l.CE)("div",Ae,[(0,l.Lk)("div",Se,[t[5]||(t[5]=(0,l.Lk)("h2",null,"提交订单",-1)),(0,l.Lk)("div",Te,[t[2]||(t[2]=(0,l.Lk)("h3",null,"已选择的菜品：",-1)),o.items.length?((0,l.uX)(),(0,l.CE)("ul",Oe,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.items,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,I.v_)(e),1)))),128))])):((0,l.uX)(),(0,l.CE)("p",$e,"暂无菜品，请返回菜单选择"))]),(0,l.Lk)("div",Me,[(0,l.Lk)("h3",null,"总价：￥"+(0,I.v_)(o.totalPrice.toFixed(2)),1)]),(0,l.Lk)("div",Ne,[t[4]||(t[4]=(0,l.Lk)("label",{for:"coupon"},"可用优惠券：",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedCoupon=e),id:"coupon"},[t[3]||(t[3]=(0,l.Lk)("option",{value:"0"},"不使用优惠券",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.coupons,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.coupon_id,value:e.discount_amount}," 优惠券"+(0,I.v_)(e.coupon_id)+"：满"+(0,I.v_)(e.min_threshold)+"减"+(0,I.v_)(e.discount_amount),9,Ve)))),128))],512),[[s.u1,o.selectedCoupon]])]),(0,l.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>n.confirmOrder&&n.confirmOrder(...e))},"确认提交订单")])])}var xe={data(){return{username:"",items:[],totalPrice:0,coupons:[],selectedCoupon:0}},created(){const e=localStorage.getItem("orderData");if(e)try{const t=JSON.parse(e);this.username=t.username,this.totalPrice=parseFloat(t.totalPrice),this.items=t.items||[],this.username&&this.items.length&&this.fetchCoupons()}catch(t){console.warn("订单数据解析失败",t)}},methods:{async fetchCoupons(){try{const e=await b.A.post("http://localhost:8080/api/order/fetch-coupons",{username:this.username,totalPrice:this.totalPrice});e.data.success?this.coupons=e.data.availableCoupons||[]:alert("优惠券加载失败")}catch(e){console.error("优惠券请求失败",e)}},async confirmOrder(){try{const e=await b.A.post("http://localhost:8080/api/order/submit-order",{username:this.username,totalPrice:this.totalPrice,items:this.items,selectedCoupon:this.selectedCoupon});e.data.success?(alert(`订单提交成功！优惠：￥${this.selectedCoupon}`),this.$router.push({path:"/my-account"})):"tableNumberNotFound"===e.data.errorCode?(alert("你还未预定餐桌！"),this.$router.push({path:"/ordertable"})):alert("订单提交失败，请稍后再试！")}catch(e){console.error("订单提交失败",e),alert("提交订单失败！")}}}};const Je=(0,i.A)(xe,[["render",Ue],["__scopeId","data-v-7502f368"]]);var Ke=Je;const Re={class:"container"},qe={class:"sidebar"},Qe={class:"content"},je={class:"membership-info"},He={key:0},Be={key:1},ze={class:"membership-actions"},Ye={key:0,class:"info-box"};function Ge(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",Re,[(0,l.Lk)("div",qe,[t[11]||(t[11]=(0,l.Lk)("h2",null,"选择",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/menu"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("菜单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/coupon"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("优惠劵")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/ordertable"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/package"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/orders"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("历史订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/takeaway-order"},{default:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.eW)("外送订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/reviews"},{default:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.eW)("菜品评价")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/exchange"},{default:(0,l.k6)((()=>t[10]||(t[10]=[(0,l.eW)("积分兑换")]))),_:1})])])]),(0,l.Lk)("div",Qe,[(0,l.Lk)("div",je,[t[13]||(t[13]=(0,l.Lk)("h2",null,"会员信息",-1)),o.user?((0,l.uX)(),(0,l.CE)("div",He,[(0,l.Lk)("p",null,"用户ID："+(0,I.v_)(o.user.userId),1),(0,l.Lk)("p",null,"用户名："+(0,I.v_)(o.user.username),1),(0,l.Lk)("p",null,"会员等级："+(0,I.v_)(o.user.memberLevel),1),(0,l.Lk)("p",null,"账户余额：￥"+(0,I.v_)(o.user.memberBalance),1),(0,l.Lk)("p",null,"会员积分："+(0,I.v_)(o.user.memberPoints),1)])):((0,l.uX)(),(0,l.CE)("div",Be,t[12]||(t[12]=[(0,l.Lk)("p",null,"加载会员信息失败，请稍后再试。",-1)])))]),(0,l.Lk)("div",ze,[t[17]||(t[17]=(0,l.Lk)("h2",null,"会员操作",-1)),(0,l.Lk)("form",{onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>n.submitRecharge&&n.submitRecharge(...e)),["prevent"]))},[t[14]||(t[14]=(0,l.Lk)("label",{for:"amount"},"充值金额：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"amount","onUpdate:modelValue":t[0]||(t[0]=e=>o.rechargeAmount=e),placeholder:"请输入充值金额"},null,512),[[s.Jo,o.rechargeAmount]]),(0,l.Lk)("span",{class:"tooltip-icon",onClick:t[1]||(t[1]=(...e)=>n.toggleInfoBox&&n.toggleInfoBox(...e))},"!"),t[15]||(t[15]=(0,l.Lk)("button",{type:"submit"},"充值",-1))],32),o.showInfoBox?((0,l.uX)(),(0,l.CE)("div",Ye,t[16]||(t[16]=[(0,l.Lk)("p",{class:"info-text"},"1.充值500元成为 VIP1，充值1000元成为 VIP2，充值2000元成为 VIP3。",-1),(0,l.Lk)("p",{class:"info-text"},"2.VIP1打九五折，VIP2打八八折，VIP3打七五折",-1)]))):(0,l.Q3)("",!0)])])])}var Ze={data(){return{user:null,rechargeAmount:"",showInfoBox:!1,statusMessage:""}},created(){const e=localStorage.getItem("username");e?this.loadUserInfo(e):(alert("请先登录"),this.$router.push("/login"))},methods:{async loadUserInfo(e){try{const t=await b.A.get(`http://localhost:8080/api/user/${e}`);"success"===t.data.status?this.user=t.data.user:alert(t.data.message||"获取用户信息失败")}catch(t){console.error("加载用户信息失败",t),alert("请求出错："+t)}},async submitRecharge(){if(isNaN(this.rechargeAmount)||parseFloat(this.rechargeAmount)<=0)alert("请输入有效的充值金额！");else try{const e=await b.A.post("http://localhost:8080/api/recharge",{username:localStorage.getItem("username"),amount:parseFloat(this.rechargeAmount)});"success"===e.data.status?(alert("充值成功！"),this.loadUserInfo(localStorage.getItem("username"))):this.statusMessage=e.data.message||"充值失败，请稍后再试！"}catch(e){console.error("充值操作失败:",e),alert("充值失败，请稍后再试！")}},toggleInfoBox(){this.showInfoBox=!this.showInfoBox}}};const et=(0,i.A)(Ze,[["render",Ge],["__scopeId","data-v-45ed70df"]]);var tt=et;const at={class:"container"},st={class:"sidebar"},lt={class:"order-container"},rt={key:0,class:"orders-list"},ot={class:"order-header"},nt={class:"order-info"},it={class:"order-total"},ut={class:"order-details"},ct={class:"payment-status"},dt={key:0},kt={key:1},pt={class:"action-btn"},ht=["onClick"],mt={key:1},vt={key:0,class:"payment-dialog"},Lt={class:"dialog-content"};function gt(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",at,[(0,l.Lk)("div",st,[t[12]||(t[12]=(0,l.Lk)("h3",null,"选择",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/my-account"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("个人主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/menu"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("菜单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/coupon"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("优惠劵")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/ordertable"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/package"},{default:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/takeaway-order"},{default:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.eW)("外送订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/reviews"},{default:(0,l.k6)((()=>t[10]||(t[10]=[(0,l.eW)("菜品评价")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/exchange"},{default:(0,l.k6)((()=>t[11]||(t[11]=[(0,l.eW)("积分兑换")]))),_:1})])])]),(0,l.Lk)("div",lt,[t[22]||(t[22]=(0,l.Lk)("h2",null,"我的订单",-1)),r.orders.length?((0,l.uX)(),(0,l.CE)("div",rt,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.orders,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.order_id,class:"order-item"},[(0,l.Lk)("div",ot,[(0,l.Lk)("div",nt,[(0,l.Lk)("p",null,[t[13]||(t[13]=(0,l.Lk)("strong",null,"订单ID：",-1)),(0,l.eW)((0,I.v_)(e.order_id),1)]),(0,l.Lk)("p",null,[t[14]||(t[14]=(0,l.Lk)("strong",null,"桌号：",-1)),(0,l.eW)((0,I.v_)(e.table_number),1)]),(0,l.Lk)("p",null,[t[15]||(t[15]=(0,l.Lk)("strong",null,"时间：",-1)),(0,l.eW)((0,I.v_)(o.formatDate(e.time_ordered)),1)])]),(0,l.Lk)("div",it,[(0,l.Lk)("p",null,[t[16]||(t[16]=(0,l.Lk)("strong",null,"总价格：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.price.toFixed(2)),1)])])]),(0,l.Lk)("div",ut,[(0,l.Lk)("p",null,[t[17]||(t[17]=(0,l.Lk)("strong",null,"菜品：",-1)),(0,l.eW)((0,I.v_)(e.dish_list),1)])]),(0,l.Lk)("div",ct,[(0,l.Lk)("p",null,[t[18]||(t[18]=(0,l.Lk)("strong",null,"支付状态：",-1)),(0,l.Lk)("span",{class:(0,I.C4)({unpaid:!e.is_paid})},(0,I.v_)(e.is_paid?"✅ 已结账":"❌ 未结账"),3)]),e.is_coupon_used?((0,l.uX)(),(0,l.CE)("p",dt,[t[19]||(t[19]=(0,l.Lk)("strong",null,"使用优惠券：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.discount_amount||0),1)])):((0,l.uX)(),(0,l.CE)("p",kt,t[20]||(t[20]=[(0,l.Lk)("strong",null,"未使用优惠券",-1)])))]),(0,l.Lk)("div",pt,[e.is_paid?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:t=>o.openPaymentDialog(e.order_id)},"立即结账",8,ht))])])))),128))])):((0,l.uX)(),(0,l.CE)("div",mt,t[21]||(t[21]=[(0,l.Lk)("p",null,"暂无订单记录",-1)])))]),r.isPaymentDialogVisible?((0,l.uX)(),(0,l.CE)("div",vt,[(0,l.Lk)("div",Lt,[t[23]||(t[23]=(0,l.Lk)("h3",null,"选择支付方式",-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.payWithAlipay&&o.payWithAlipay(...e))},"支付宝"),(0,l.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.payWithWeChat&&o.payWithWeChat(...e))},"微信"),(0,l.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.payWithCard&&o.payWithCard(...e))},"储值卡"),(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>o.closePaymentDialog&&o.closePaymentDialog(...e))},"关闭")])])):(0,l.Q3)("",!0)])}var bt={data(){return{orders:[],isPaymentDialogVisible:!1,currentOrderId:null}},created(){this.fetchOrders()},methods:{async fetchOrders(){const e=localStorage.getItem("username");if(!e)return alert("请先登录"),void this.$router.push("/login");try{const t=await b.A.get(`http://localhost:8080/api/order/my-orders?username=${e}`);t.data.success?this.orders=t.data.orders:alert("加载订单失败")}catch(t){console.error("获取订单失败",t),alert("网络错误，无法加载订单")}},formatDate(e){const t=new Date(e),a=t.getUTCFullYear(),s=(t.getUTCMonth()+1).toString().padStart(2,"0"),l=t.getUTCDate().toString().padStart(2,"0"),r=t.getUTCHours().toString().padStart(2,"0"),o=t.getUTCMinutes().toString().padStart(2,"0"),n=t.getUTCSeconds().toString().padStart(2,"0");return`${a}-${s}-${l} ${r}:${o}:${n}`},openPaymentDialog(e){this.currentOrderId=e,this.isPaymentDialogVisible=!0},closePaymentDialog(){this.isPaymentDialogVisible=!1,this.currentOrderId=null},async payWithAlipay(){this.processPayment("alipay")},async payWithWeChat(){this.processPayment("wechat")},async payWithCard(){this.processPayment("card")},async processPayment(e){try{const t=await b.A.post("http://localhost:8080/api/order/checkout",{order_id:this.currentOrderId,payment_method:e});t.data.success?(this.closePaymentDialog(),alert("支付成功"),this.fetchOrders()):alert("支付失败")}catch(t){console.error("支付失败",t),alert("支付过程中出现错误")}}}};const yt=(0,i.A)(bt,[["render",gt],["__scopeId","data-v-5b04e8cb"]]);var ft=yt;const _t={class:"container"},Ct={class:"sidebar"},It={class:"content"},Pt={class:"coupon-group"},Wt={key:0},Ft={class:"coupon-header"},Dt={class:"coupon-id"},wt={class:"coupon-details"},Et={key:1};function Xt(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",_t,[(0,l.Lk)("div",Ct,[t[8]||(t[8]=(0,l.Lk)("h2",null,"导航",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/menu"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)("菜单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/my-account"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)("用户主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/ordertable"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/package"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/orders"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("历史订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/takeaway-order"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("外送订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/reviews"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("菜品评价")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/exchange"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("积分兑换")]))),_:1})])])]),(0,l.Lk)("div",It,[t[14]||(t[14]=(0,l.Lk)("h2",null,"我的优惠券",-1)),(0,l.Lk)("div",Pt,[r.coupons.length>0?((0,l.uX)(),(0,l.CE)("div",Wt,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.sortedCoupons,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.couponId,class:(0,I.C4)(["coupon-item",{"expired-coupon":!o.isActive(e.expiryDate)}])},[(0,l.Lk)("div",Ft,[(0,l.Lk)("p",Dt,"优惠券ID: "+(0,I.v_)(e.couponId),1),(0,l.Lk)("p",{class:(0,I.C4)(["coupon-status",{active:o.isActive(e.expiryDate),expired:!o.isActive(e.expiryDate)}])},(0,I.v_)(o.isActive(e.expiryDate)?"有效":"过期"),3)]),(0,l.Lk)("div",wt,[(0,l.Lk)("p",null,[t[9]||(t[9]=(0,l.Lk)("strong",null,"开始日期:",-1)),(0,l.eW)(" "+(0,I.v_)(o.formatDate(e.startDate)),1)]),(0,l.Lk)("p",null,[t[10]||(t[10]=(0,l.Lk)("strong",null,"过期日期:",-1)),(0,l.eW)(" "+(0,I.v_)(o.formatDate(e.expiryDate)),1)]),(0,l.Lk)("p",null,[t[11]||(t[11]=(0,l.Lk)("strong",null,"最低消费金额:",-1)),(0,l.eW)(" ￥"+(0,I.v_)(e.minThreshold),1)]),(0,l.Lk)("p",null,[t[12]||(t[12]=(0,l.Lk)("strong",null,"折扣金额:",-1)),(0,l.eW)(" ￥"+(0,I.v_)(e.discountAmount),1)])])],2)))),128))])):((0,l.uX)(),(0,l.CE)("div",Et,t[13]||(t[13]=[(0,l.Lk)("p",null,"您没有可用的优惠券。",-1)])))])])])}var At={data(){return{coupons:[]}},mounted(){this.fetchCoupons()},computed:{sortedCoupons(){return this.coupons.slice().sort(((e,t)=>this.isActive(t.expiryDate)-this.isActive(e.expiryDate)))}},methods:{fetchCoupons(){const e=localStorage.getItem("username");e&&fetch(`/api/coupons/${e}`).then((e=>e.json())).then((e=>{this.coupons=e||[]})).catch((e=>{console.error("Error fetching coupons:",e)}))},formatDate(e){const t=new Date(e),a={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return t.toLocaleString("zh-CN",a)},isActive(e){const t=new Date;return new Date(e)>t}}};const St=(0,i.A)(At,[["render",Xt],["__scopeId","data-v-1c58828c"]]);var Tt=St;const Ot={class:"admin-container"},$t={class:"card"},Mt={key:0,class:"preview-img"},Nt=["src"],Vt={class:"card"},Ut={class:"dish-selection"},xt={class:"actions"},Jt=["onClick"],Kt=["onClick"],Rt={class:"card"},qt={class:"dish-list"},Qt=["onClick"],jt={class:"card"},Ht={class:"package-list"},Bt=["onClick"];function zt(e,t,a,r,o,n){return(0,l.uX)(),(0,l.CE)("div",Ot,[t[13]||(t[13]=(0,l.Lk)("h1",null,"🍽️ 食尚阁 - 管理后台",-1)),(0,l.Lk)("section",$t,[t[7]||(t[7]=(0,l.Lk)("h2",null,"上传菜品",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.newDish.dishName=e),placeholder:"菜品名称"},null,512),[[s.Jo,o.newDish.dishName]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.newDish.dishPrice=e),placeholder:"价格",type:"number"},null,512),[[s.Jo,o.newDish.dishPrice,void 0,{number:!0}]]),(0,l.Lk)("input",{type:"file",onChange:t[2]||(t[2]=(...e)=>n.onImageSelected&&n.onImageSelected(...e)),accept:"image/*"},null,32),o.previewImage?((0,l.uX)(),(0,l.CE)("div",Mt,[(0,l.Lk)("img",{src:o.previewImage,alt:"预览图"},null,8,Nt)])):(0,l.Q3)("",!0),(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.uploadDish&&n.uploadDish(...e))},"上传")]),(0,l.Lk)("section",Vt,[t[9]||(t[9]=(0,l.Lk)("h2",null,"上传套餐",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.newPackage.packageName=e),placeholder:"套餐名称"},null,512),[[s.Jo,o.newPackage.packageName]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>o.newPackage.discount=e),placeholder:"折扣 (如0.8表示8折)",type:"number"},null,512),[[s.Jo,o.newPackage.discount,void 0,{number:!0}]]),(0,l.Lk)("div",Ut,[t[8]||(t[8]=(0,l.Lk)("h3",null,"选择菜品",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.dishes,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"dish-row"},[(0,l.Lk)("span",null,(0,I.v_)(e.dishName),1),(0,l.Lk)("div",xt,[(0,l.Lk)("button",{onClick:t=>n.addToPackage(e)},"+",8,Jt),(0,l.Lk)("button",{onClick:t=>n.removeFromPackage(e)},"-",8,Kt)])])))),128))]),t[10]||(t[10]=(0,l.Lk)("h4",null,"已选菜品：",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.selectedDishes,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id},(0,I.v_)(e.dishName),1)))),128))]),(0,l.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.uploadPackage&&n.uploadPackage(...e))},"上传套餐")]),(0,l.Lk)("section",Rt,[t[11]||(t[11]=(0,l.Lk)("h2",null,"删除菜品",-1)),(0,l.Lk)("ul",qt,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.dishes,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id,class:"dish-row"},[(0,l.Lk)("span",null,(0,I.v_)(e.dishName),1),(0,l.Lk)("button",{onClick:t=>n.deleteDish(e)},"删除",8,Qt)])))),128))])]),(0,l.Lk)("section",jt,[t[12]||(t[12]=(0,l.Lk)("h2",null,"删除套餐",-1)),(0,l.Lk)("ul",Ht,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.packages,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.packageId,class:"package-row"},[(0,l.Lk)("span",null,(0,I.v_)(e.packageName)+" - ￥"+(0,I.v_)(e.packagePrice),1),(0,l.Lk)("button",{onClick:t=>n.deletePackage(e)},"删除",8,Bt)])))),128))])])])}var Yt={name:"AdminPage",data(){return{dishes:[],packages:[],newDish:{dishName:"",dishPrice:null},newPackage:{packageName:"",discount:null},selectedDishes:[],imageFile:null,previewImage:null}},created(){this.loadDishes(),this.loadPackages()},methods:{async loadDishes(){const e=await b.A.get("http://localhost:8080/api/menu");this.dishes=e.data},async loadPackages(){const e=await b.A.get("http://localhost:8080/api/packages");this.packages=e.data},onImageSelected(e){this.imageFile=e.target.files[0],this.imageFile&&(this.previewImage=URL.createObjectURL(this.imageFile))},async uploadDish(){if(!this.newDish.dishName||!this.newDish.dishPrice)return alert("请填写完整菜品信息！");const e=new FormData;e.append("dishName",this.newDish.dishName),e.append("dishPrice",this.newDish.dishPrice),this.imageFile&&e.append("image",this.imageFile),await b.A.post("http://localhost:8080/api/menu/upload",e),this.newDish.dishName="",this.newDish.dishPrice=null,this.imageFile=null,this.previewImage=null,this.loadDishes(),alert("菜品上传成功！")},addToPackage(e){this.selectedDishes.includes(e)||this.selectedDishes.push(e)},removeFromPackage(e){this.selectedDishes=this.selectedDishes.filter((t=>t.id!==e.id))},async uploadPackage(){if(!this.newPackage.packageName||!this.selectedDishes.length)return alert("请填写套餐信息并选择菜品！");const e={packageName:this.newPackage.packageName,discount:this.newPackage.discount,selectedItems:this.selectedDishes.map((e=>e.dishName))};await b.A.post("http://localhost:8080/api/packages/upload",e),this.newPackage.packageName="",this.newPackage.discount=1,this.selectedDishes=[],this.loadPackages(),alert("套餐上传成功！")},async deleteDish(e){confirm(`确定要删除菜品 ${e.dishName} 吗？`)&&(await b.A.delete(`http://localhost:8080/api/menu/${e.id}`),this.loadDishes())},async deletePackage(e){confirm(`确定要删除套餐 ${e.packageName} 吗？`)&&(await b.A.delete(`http://localhost:8080/api/packages/${e.packageId}`),this.loadPackages())}}};const Gt=(0,i.A)(Yt,[["render",zt],["__scopeId","data-v-5cf9271b"]]);var Zt=Gt;const ea={class:"container"},ta={class:"sidebar"},aa={class:"order-container"},sa={key:0,class:"orders-list"},la={class:"order-header"},ra={class:"order-info"},oa={class:"order-total"},na={class:"order-details"},ia={class:"review-section"},ua={key:0,class:"review-form"},ca=["onUpdate:modelValue"],da=["value"],ka=["onUpdate:modelValue"],pa=["onClick"],ha={key:1,class:"reviewed-message"},ma={key:1};function va(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("div",ea,[(0,l.Lk)("div",ta,[t[8]||(t[8]=(0,l.Lk)("h3",null,"选择",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/my-account"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)("用户主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/menu"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)("菜单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/coupon"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)("优惠劵")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/ordertable"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/package"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/orders"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("历史订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/takeaway-order"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("外送订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/exchange"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("积分兑换")]))),_:1})])])]),(0,l.Lk)("div",aa,[t[18]||(t[18]=(0,l.Lk)("h2",null,"我的评价",-1)),o.orders.length?((0,l.uX)(),(0,l.CE)("div",sa,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.orders,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.order_id,class:"order-item"},[(0,l.Lk)("div",la,[(0,l.Lk)("div",ra,[(0,l.Lk)("p",null,[t[9]||(t[9]=(0,l.Lk)("strong",null,"订单ID：",-1)),(0,l.eW)((0,I.v_)(e.order_id),1)]),(0,l.Lk)("p",null,[t[10]||(t[10]=(0,l.Lk)("strong",null,"桌号：",-1)),(0,l.eW)((0,I.v_)(e.table_number),1)]),(0,l.Lk)("p",null,[t[11]||(t[11]=(0,l.Lk)("strong",null,"时间：",-1)),(0,l.eW)((0,I.v_)(n.formatDate(e.time_ordered)),1)])]),(0,l.Lk)("div",oa,[(0,l.Lk)("p",null,[t[12]||(t[12]=(0,l.Lk)("strong",null,"总价格：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.price.toFixed(2)),1)])])]),(0,l.Lk)("div",na,[(0,l.Lk)("p",null,[t[13]||(t[13]=(0,l.Lk)("strong",null,"菜品：",-1)),(0,l.eW)((0,I.v_)(e.dish_list),1)])]),(0,l.Lk)("div",ia,[e.reviewed?((0,l.uX)(),(0,l.CE)("div",ha,[t[16]||(t[16]=(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"您已经评价过该订单。")],-1)),(0,l.Lk)("p",null,"评分："+(0,I.v_)(e.rating),1),(0,l.Lk)("p",null,"评论："+(0,I.v_)(e.comment),1)])):((0,l.uX)(),(0,l.CE)("div",ua,[t[14]||(t[14]=(0,l.Lk)("label",null,"评分：",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t=>e.rating=t},[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(5,(e=>(0,l.Lk)("option",{key:e,value:e},(0,I.v_)(e),9,da))),64))],8,ca),[[s.u1,e.rating]]),t[15]||(t[15]=(0,l.Lk)("label",null,"评论：",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t=>e.comment=t,rows:"3"},null,8,ka),[[s.Jo,e.comment]]),(0,l.Lk)("button",{onClick:t=>n.submitReview(e)},"提交评价",8,pa)]))])])))),128))])):((0,l.uX)(),(0,l.CE)("div",ma,t[17]||(t[17]=[(0,l.Lk)("p",null,"暂无订单记录",-1)])))])])])}var La={name:"MyReviewPage",data(){return{orders:[]}},created(){this.fetchOrders()},methods:{async fetchOrders(){const e=localStorage.getItem("username");if(!e)return alert("请先登录"),void this.$router.push("/login");try{const t=await b.A.get(`http://localhost:8080/api/orders?username=${e}`);this.orders=t.data.map((e=>({...e,rating:e.rating||5,comment:e.comment||""})))}catch(t){alert("加载失败")}},formatDate(e){const t=new Date(e),a=t.getFullYear(),s=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),n=t.getSeconds().toString().padStart(2,"0");return`${a}-${s}-${l} ${r}:${o}:${n}`},async submitReview(e){try{await b.A.post("http://localhost:8080/api/submit-review",{order_id:e.order_id,rating:e.rating,comment:e.comment}),e.reviewed=!0}catch(t){alert("提交失败")}}}};const ga=(0,i.A)(La,[["render",va],["__scopeId","data-v-cdb7c7f0"]]);var ba=ga;const ya={class:"container"},fa={class:"sidebar"},_a={class:"content"};function Ca(e,t,a,s,r,o){const n=(0,l.g2)("router-link"),i=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",ya,[(0,l.Lk)("div",fa,[t[4]||(t[4]=(0,l.Lk)("div",{class:"header"},[(0,l.Lk)("h1",null,"🍽️ 食尚阁 - 前台管理系统")],-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/check-orders"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)("💵 查看订单及结账")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)("🎟️ 分配优惠券")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-delivery"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)("🛵 外卖员管理")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("🪑 餐桌预定")]))),_:1})])])]),(0,l.Lk)("div",_a,[(0,l.bF)(i)])])}var Ia={name:"FrontendManagement"};const Pa=(0,i.A)(Ia,[["render",Ca],["__scopeId","data-v-73e0a154"]]);var Wa=Pa;const Fa={class:"container"},Da={class:"sidebar"},wa={class:"order-container"},Ea={key:0,class:"orders-list"},Xa={class:"order-header"},Aa={class:"order-info"},Sa={class:"order-total"},Ta={class:"order-details"},Oa={class:"payment-status"},$a={key:0},Ma={key:1},Na={class:"action-btn"},Va=["onClick"],Ua={key:1},xa={key:0,class:"payment-dialog"},Ja={class:"dialog-content"};function Ka(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",Fa,[(0,l.Lk)("div",Da,[t[8]||(t[8]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/counter"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("🏠 回到管理主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("🎟️ 分配优惠券")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-delivery"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("🛵 外卖员管理")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("🪑 餐桌预定")]))),_:1})])])]),(0,l.Lk)("div",wa,[t[19]||(t[19]=(0,l.Lk)("h2",null,"💵 所有订单",-1)),r.orders.length?((0,l.uX)(),(0,l.CE)("div",Ea,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.orders,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.order_id,class:"order-item"},[(0,l.Lk)("div",Xa,[(0,l.Lk)("div",Aa,[(0,l.Lk)("p",null,[t[9]||(t[9]=(0,l.Lk)("strong",null,"订单ID：",-1)),(0,l.eW)((0,I.v_)(e.order_id),1)]),(0,l.Lk)("p",null,[t[10]||(t[10]=(0,l.Lk)("strong",null,"用户ID：",-1)),(0,l.eW)((0,I.v_)(e.user_id),1)]),(0,l.Lk)("p",null,[t[11]||(t[11]=(0,l.Lk)("strong",null,"桌号：",-1)),(0,l.eW)((0,I.v_)(e.table_number),1)]),(0,l.Lk)("p",null,[t[12]||(t[12]=(0,l.Lk)("strong",null,"时间：",-1)),(0,l.eW)((0,I.v_)(o.formatDate(e.time_ordered)),1)])]),(0,l.Lk)("div",Sa,[(0,l.Lk)("p",null,[t[13]||(t[13]=(0,l.Lk)("strong",null,"总价格：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.price.toFixed(2)),1)])])]),(0,l.Lk)("div",Ta,[(0,l.Lk)("p",null,[t[14]||(t[14]=(0,l.Lk)("strong",null,"菜品：",-1)),(0,l.eW)((0,I.v_)(e.dish_list),1)])]),(0,l.Lk)("div",Oa,[(0,l.Lk)("p",null,[t[15]||(t[15]=(0,l.Lk)("strong",null,"支付状态：",-1)),(0,l.Lk)("span",{class:(0,I.C4)({unpaid:!e.is_paid})},(0,I.v_)(e.is_paid?"✅ 已结账":"❌ 未结账"),3)]),e.is_coupon_used?((0,l.uX)(),(0,l.CE)("p",$a,[t[16]||(t[16]=(0,l.Lk)("strong",null,"使用优惠券：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.discount_amount||0),1)])):((0,l.uX)(),(0,l.CE)("p",Ma,t[17]||(t[17]=[(0,l.Lk)("strong",null,"未使用优惠券",-1)])))]),(0,l.Lk)("div",Na,[e.is_paid?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:t=>o.openPaymentDialog(e.order_id)},"立即结账",8,Va))])])))),128))])):((0,l.uX)(),(0,l.CE)("div",Ua,t[18]||(t[18]=[(0,l.Lk)("p",null,"暂无订单记录",-1)])))]),r.isPaymentDialogVisible?((0,l.uX)(),(0,l.CE)("div",xa,[(0,l.Lk)("div",Ja,[t[20]||(t[20]=(0,l.Lk)("h3",null,"选择支付方式",-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.payWithAlipay&&o.payWithAlipay(...e))},"支付宝"),(0,l.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.payWithWeChat&&o.payWithWeChat(...e))},"微信"),(0,l.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.payWithCard&&o.payWithCard(...e))},"储值卡"),(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>o.closePaymentDialog&&o.closePaymentDialog(...e))},"关闭")])])):(0,l.Q3)("",!0)])}var Ra={data(){return{orders:[],isPaymentDialogVisible:!1,currentOrderId:null}},created(){this.fetchOrders()},methods:{async fetchOrders(){try{const e=await b.A.get("http://localhost:8080/api/order/get-all-orders");e.data.success?this.orders=e.data.orders:alert("加载所有订单失败")}catch(e){console.error("获取所有订单失败",e),alert("网络错误，无法加载所有订单")}},formatDate(e){const t=new Date(e),a=t.getFullYear(),s=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),n=t.getSeconds().toString().padStart(2,"0");return`${a}-${s}-${l} ${r}:${o}:${n}`},openPaymentDialog(e){this.currentOrderId=e,this.isPaymentDialogVisible=!0},closePaymentDialog(){this.isPaymentDialogVisible=!1,this.currentOrderId=null},async payWithAlipay(){this.processPayment("alipay")},async payWithWeChat(){this.processPayment("wechat")},async payWithCard(){this.processPayment("card")},async processPayment(e){try{const t=await b.A.post("http://localhost:8080/api/order/checkout",{order_id:this.currentOrderId,payment_method:e});t.data.success?(this.closePaymentDialog(),alert("支付成功"),this.fetchOrders()):alert("支付失败")}catch(t){console.error("支付失败",t),alert("支付过程中出现错误")}}}};const qa=(0,i.A)(Ra,[["render",Ka],["__scopeId","data-v-6708e323"]]);var Qa=qa;const ja={class:"container"},Ha={class:"sidebar"},Ba={class:"content"},za={class:"form-group"},Ya={class:"form-group"},Ga={class:"form-group"},Za={class:"form-group"},es={class:"form-group"};function ts(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",ja,[(0,l.Lk)("div",Ha,[t[10]||(t[10]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/counter"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("🏠 回到管理主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/check-orders"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("💵 查看订单及结账")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/manage-delivery"},{default:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.eW)("🛵 外卖员管理")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.eW)("🪑 餐桌预定")]))),_:1})])])]),(0,l.Lk)("div",Ba,[t[17]||(t[17]=(0,l.Lk)("h2",{class:"page-title"},"🎟️ 分配优惠券",-1)),(0,l.Lk)("form",{onSubmit:t[5]||(t[5]=(0,s.D$)(((...e)=>r.submitForm&&r.submitForm(...e)),["prevent"])),class:"coupon-form"},[(0,l.Lk)("div",za,[t[11]||(t[11]=(0,l.Lk)("label",null,"用户 ID（填 ALL 分发全部）:",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.userId=e),placeholder:"如：1 或 ALL",required:""},null,512),[[s.Jo,r.form.userId]])]),(0,l.Lk)("div",Ya,[t[12]||(t[12]=(0,l.Lk)("label",null,"开始时间:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local","onUpdate:modelValue":t[1]||(t[1]=e=>r.form.startDate=e),required:""},null,512),[[s.Jo,r.form.startDate]])]),(0,l.Lk)("div",Ga,[t[13]||(t[13]=(0,l.Lk)("label",null,"结束时间:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local","onUpdate:modelValue":t[2]||(t[2]=e=>r.form.endDate=e),required:""},null,512),[[s.Jo,r.form.endDate]])]),(0,l.Lk)("div",Za,[t[14]||(t[14]=(0,l.Lk)("label",null,"满减门槛（元）:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>r.form.minThreshold=e),required:""},null,512),[[s.Jo,r.form.minThreshold]])]),(0,l.Lk)("div",es,[t[15]||(t[15]=(0,l.Lk)("label",null,"优惠金额（元）:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>r.form.discountAmount=e),required:""},null,512),[[s.Jo,r.form.discountAmount]])]),t[16]||(t[16]=(0,l.Lk)("button",{type:"submit"},"🚀 分发优惠券",-1))],32),r.message?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,I.C4)([{success:r.success,error:!r.success},"message"])},(0,I.v_)(r.message),3)):(0,l.Q3)("",!0)])])}var as={name:"DistributeCoupons",setup(){const e=(0,g.KR)({userId:"",startDate:"",endDate:"",minThreshold:"",discountAmount:""}),t=(0,g.KR)(""),a=(0,g.KR)(!1),s=async()=>{try{const s=await b.A.post("/api/coupons/distribute",e.value);a.value=s.data.success,t.value=s.data.message}catch(s){a.value=!1,t.value="请求出错，请稍后再试。",console.error(s)}};return{form:e,message:t,success:a,submitForm:s}}};const ss=(0,i.A)(as,[["render",ts],["__scopeId","data-v-45cb4ce2"]]);var ls=ss;const rs={class:"container"},os={class:"sidebar"},ns={class:"order-container"},is={class:"points"},us={class:"orders-list"},cs={class:"order-header"},ds={class:"action-btn"},ks=["disabled","onClick"];function ps(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",rs,[(0,l.Lk)("div",os,[t[8]||(t[8]=(0,l.Lk)("h3",null,"选择",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/my-account"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)("个人主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/menu"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)("菜单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/coupon"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)("优惠劵")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/ordertable"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/package"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/takeaway-order"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("外送订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/reviews"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("菜品评价")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/exchange"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("积分兑换")]))),_:1})])])]),(0,l.Lk)("div",ns,[t[9]||(t[9]=(0,l.Lk)("h2",null,"积分兑换",-1)),(0,l.Lk)("p",is,"当前积分："+(0,I.v_)(r.userPoints.toFixed(2)),1),(0,l.Lk)("div",us,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.coupons,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"order-item",key:e.id},[(0,l.Lk)("div",cs,[(0,l.Lk)("h3",null,"满 "+(0,I.v_)(e.minThreshold)+" 减 "+(0,I.v_)(e.discountAmount),1),(0,l.Lk)("p",null,"所需积分："+(0,I.v_)(e.requiredPoints),1)]),(0,l.Lk)("div",ds,[(0,l.Lk)("button",{disabled:r.userPoints<e.requiredPoints,onClick:t=>o.redeemCoupon(e)},(0,I.v_)(r.userPoints>=e.requiredPoints?"立即兑换":"积分不足"),9,ks)])])))),128))])])])}var hs={name:"ExchangePage",data(){return{userPoints:0,coupons:[{id:1,minThreshold:200,discountAmount:20,requiredPoints:1e3},{id:2,minThreshold:500,discountAmount:50,requiredPoints:2500},{id:3,minThreshold:1e3,discountAmount:100,requiredPoints:5e3}]}},created(){this.fetchUserPoints()},methods:{async fetchUserPoints(){const e=localStorage.getItem("username");if(!e)return alert("请先登录"),void this.$router.push("/login");try{const t=await b.A.get(`http://localhost:8080/api/exchange/points?username=${e}`);this.userPoints=t.data.points}catch(t){console.error("获取积分失败：",t),alert("获取积分失败："+t.message)}},async redeemCoupon(e){const t=localStorage.getItem("username");try{const a=await b.A.post("http://localhost:8080/api/exchange/redeem",{username:t,requiredPoints:e.requiredPoints,minThreshold:e.minThreshold,discountAmount:e.discountAmount});a.data.success?(alert("兑换成功！"),this.fetchUserPoints()):alert("兑换失败："+a.data.message)}catch(a){console.error("兑换失败：",a),alert("兑换出错："+a.message)}}}};const ms=(0,i.A)(hs,[["render",ps],["__scopeId","data-v-5037c7c4"]]);var vs=ms;const Ls={class:"container"},gs={class:"checkout-form"},bs={class:"selected-items"},ys={class:"form-group"},fs={class:"form-group"},_s={class:"coupon-select"},Cs=["value"];function Is(e,t,a,r,o,n){return(0,l.uX)(),(0,l.CE)("div",Ls,[(0,l.Lk)("div",gs,[t[8]||(t[8]=(0,l.Lk)("h2",null,"提交外卖订单",-1)),(0,l.Lk)("div",bs,[t[4]||(t[4]=(0,l.Lk)("h3",null,"已选择的菜品：",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.dishList,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.name},(0,I.v_)(e.name)+"：￥"+(0,I.v_)(e.price),1)))),128))])]),(0,l.Lk)("div",ys,[t[5]||(t[5]=(0,l.Lk)("label",null,"送达地址：",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.deliveryAddress=e),type:"text",required:""},null,512),[[s.Jo,o.deliveryAddress]])]),(0,l.Lk)("div",fs,[t[6]||(t[6]=(0,l.Lk)("label",null,"预期送达时间：",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.deliveryTime=e),type:"datetime-local",required:""},null,512),[[s.Jo,o.deliveryTime]])]),(0,l.Lk)("div",_s,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.selectedCouponId=e)},[t[7]||(t[7]=(0,l.Lk)("option",{value:"0"},"选择优惠券",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.coupons,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.couponId,value:e.couponId}," 优惠券"+(0,I.v_)(e.couponId)+"：满"+(0,I.v_)(e.minThreshold)+"减"+(0,I.v_)(e.discountAmount),9,Cs)))),128))],512),[[s.u1,o.selectedCouponId]])]),(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.submitOrder&&n.submitOrder(...e))},"确认提交订单")])])}var Ps={data(){return{dishList:[],deliveryAddress:"",deliveryTime:"",selectedCouponId:0,coupons:[],userId:null,username:"",totalPrice:0}},computed:{calculatedPrice(){return this.dishList.reduce(((e,t)=>e+t.price),0).toFixed(2)}},async created(){const e=JSON.parse(localStorage.getItem("deliveryOrderData")||"{}");if(this.username=e.username,this.dishList=e.dishList||[],this.totalPrice=parseFloat(e.totalPrice||0),!this.username)return alert("未登录，无法下单"),void this.$router.push("/login");try{const e=await b.A.get(`http://localhost:8080/api/user/${this.username}`);"success"===e.data.status&&(this.userId=e.data.user.userId,await this.fetchCoupons())}catch(t){alert("加载用户信息失败")}},methods:{async fetchCoupons(){try{const e=await b.A.post("http://localhost:8080/api/takeaway/fetch-coupons",{username:this.username,totalPrice:this.totalPrice});console.log("原始后端数据：",e.data),e.data.success&&Array.isArray(e.data.availableCoupons)?(this.coupons=e.data.availableCoupons.map((e=>({couponId:e.coupon_id,minThreshold:e.min_threshold,discountAmount:e.discount_amount}))),console.log("转换后的前端优惠券数据：",this.coupons)):console.warn("未获取到优惠券数组！")}catch(e){console.error("加载优惠券失败",e)}},async submitOrder(){if(this.deliveryAddress&&this.deliveryTime)try{const e=0!==this.selectedCouponId?this.selectedCouponId:null,t=await b.A.post("http://localhost:8080/api/takeaway/submit",{username:this.username,address:this.deliveryAddress,estimatedTime:this.deliveryTime,items:this.dishList.map((e=>e.name)),totalPrice:this.totalPrice,selectedCoupon:e});t.data.success?(alert("下单成功！"),localStorage.removeItem("deliveryOrderData"),this.$router.push("/takeaway-order")):alert("下单失败："+(t.data.message||"未知错误"))}catch(e){alert("下单失败："+(e.response?.data?.message||e.message))}else alert("请填写送达地址和时间")}}};const Ws=(0,i.A)(Ps,[["render",Is],["__scopeId","data-v-4c5aa09b"]]);var Fs=Ws;const Ds={class:"container"},ws={class:"sidebar"},Es={class:"order-container"},Xs={key:0,class:"orders-list"},As={class:"order-info"},Ss={class:"order-details"},Ts={class:"order-total"},Os={key:0},$s={key:1},Ms={class:"payment-status"},Ns={key:0},Vs={key:1},Us={key:2},xs={key:3},Js={class:"action-btn"},Ks=["onSubmit"],Rs=["value"],qs={key:1},Qs={key:0,class:"payment-dialog"},js={class:"dialog-content"};function Hs(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",Ds,[(0,l.Lk)("div",ws,[t[13]||(t[13]=(0,l.Lk)("h3",null,"选择",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/my-account"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("个人主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/menu"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("菜单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/coupon"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("优惠劵")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/ordertable"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("订桌")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/package"},{default:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.eW)("套餐")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/orders"},{default:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.eW)("历史订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/takeaway-order"},{default:(0,l.k6)((()=>t[10]||(t[10]=[(0,l.eW)("外送订单")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/reviews"},{default:(0,l.k6)((()=>t[11]||(t[11]=[(0,l.eW)("菜品评价")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/exchange"},{default:(0,l.k6)((()=>t[12]||(t[12]=[(0,l.eW)("积分兑换")]))),_:1})])])]),(0,l.Lk)("div",Es,[t[16]||(t[16]=(0,l.Lk)("h2",null,"我的外卖订单",-1)),o.orders.length?((0,l.uX)(),(0,l.CE)("div",Xs,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.orders,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.orderId,class:"order-item"},[(0,l.Lk)("div",As,[(0,l.Lk)("p",null,"订单ID: "+(0,I.v_)(e.orderId),1),(0,l.Lk)("p",null,"时间: "+(0,I.v_)(n.formatDate(e.timeOrdered)),1)]),(0,l.Lk)("div",Ss,[(0,l.Lk)("p",null,"送达地址: "+(0,I.v_)(e.deliveryAddress),1),(0,l.Lk)("p",null,"菜品: "+(0,I.v_)(e.dishList),1)]),(0,l.Lk)("div",Ts,[(0,l.eW)(" 总价格: ￥"+(0,I.v_)(e.price)+" ",1),e.isCouponUsed?((0,l.uX)(),(0,l.CE)("p",Os," 使用了优惠券，优惠金额: ￥"+(0,I.v_)(e.discountAmount),1)):((0,l.uX)(),(0,l.CE)("p",$s," 未使用优惠券 "))]),(0,l.Lk)("div",Ms,[(0,l.Lk)("p",null,"预计送达时间："+(0,I.v_)(n.formatDate(e.estimatedDeliveryTime)),1),0!==e.deliveryPersonId?((0,l.uX)(),(0,l.CE)("p",Ns," 骑手"+(0,I.v_)(e.deliveryPersonId)+"正在全力配送，请耐心等待 ",1)):(0,l.Q3)("",!0),"delivered"===e.deliveryStatus?((0,l.uX)(),(0,l.CE)("p",Vs,(0,I.v_)(n.formatDate(e.deliveryTime))+"订单已送达，祝您用餐愉快 ",1)):"out_for_delivery"===e.deliveryStatus?((0,l.uX)(),(0,l.CE)("p",Us," 订单派送中 ")):"pending"===e.deliveryStatus?((0,l.uX)(),(0,l.CE)("p",xs," 订单等待处理 ")):(0,l.Q3)("",!0)]),(0,l.Lk)("div",Js,["delivered"!==e.deliveryStatus?((0,l.uX)(),(0,l.CE)("form",{key:0,onSubmit:(0,s.D$)((t=>n.confirmDelivery(e.orderId)),["prevent"])},[(0,l.Lk)("input",{type:"hidden",value:e.orderId,name:"orderId"},null,8,Rs),t[14]||(t[14]=(0,l.Lk)("button",{type:"submit"}," 确认收货并结账 ",-1))],40,Ks)):(0,l.Q3)("",!0)])])))),128))])):((0,l.uX)(),(0,l.CE)("div",qs,t[15]||(t[15]=[(0,l.Lk)("p",null,"暂无订单记录",-1)])))]),o.isPaymentDialogVisible?((0,l.uX)(),(0,l.CE)("div",Qs,[(0,l.Lk)("div",js,[t[17]||(t[17]=(0,l.Lk)("h3",null,"选择支付方式",-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.payWithAlipay&&n.payWithAlipay(...e))},"支付宝"),(0,l.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>n.payWithWeChat&&n.payWithWeChat(...e))},"微信"),(0,l.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.payWithCard&&n.payWithCard(...e))},"储值卡"),(0,l.Lk)("button",{class:"dialog-close-btn",onClick:t[3]||(t[3]=(...e)=>n.closePaymentDialog&&n.closePaymentDialog(...e))},"关闭")])])):(0,l.Q3)("",!0)])}var Bs={data(){return{orders:[],isPaymentDialogVisible:!1,currentOrderId:null}},created(){this.fetchOrders()},methods:{async fetchOrders(){const e=localStorage.getItem("username");if(!e)return alert("请先登录"),void this.$router.push("/login");try{const t=await b.A.get(`http://localhost:8080/api/takeaway/orders/${e}`);this.orders=t.data||[]}catch(t){console.error("加载外卖订单失败",t)}},formatDate(e){const t=new Date(e),a=t.getFullYear(),s=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),n=t.getSeconds().toString().padStart(2,"0");return`${a}-${s}-${l} ${r}:${o}:${n}`},async confirmDelivery(e){try{const t=await b.A.post("http://localhost:8080/api/takeaway/confirm",{orderId:e});t.data.success?(alert("确认收货成功"),this.openPaymentDialog(e)):alert("确认失败: "+t.data.message)}catch(t){alert("网络错误")}},openPaymentDialog(e){this.currentOrderId=e,this.isPaymentDialogVisible=!0},closePaymentDialog(){this.isPaymentDialogVisible=!1,this.currentOrderId=null},async payWithAlipay(){await this.processPayment("alipay")},async payWithWeChat(){await this.processPayment("wechat")},async payWithCard(){await this.processPayment("card")},async processPayment(e){if(this.currentOrderId)try{const t=await b.A.post("http://localhost:8080/api/takeaway/pay",{orderId:this.currentOrderId,paymentMethod:e});t.data.success?(alert("支付成功！"),this.closePaymentDialog(),this.fetchOrders()):alert("支付失败: "+t.data.message)}catch(t){alert("支付出错，请检查网络"),console.error(t)}else alert("无效的订单")}}};const zs=(0,i.A)(Bs,[["render",Hs],["__scopeId","data-v-a91964fe"]]);var Ys=zs;const Gs={class:"container"},Zs={class:"sidebar"},el={class:"content"},tl={class:"form-card"},al={class:"button-group"},sl={key:0},ll={class:"form-group"},rl={class:"form-group"},ol={class:"radio-group"},nl={class:"form-group"},il={class:"form-group"},ul=["min"],cl={key:0,class:"success-message"},dl={key:1,class:"error-message"},kl={key:1},pl={class:"form-group"},hl={key:0,class:"success-message"},ml={key:1,class:"released-tables"},vl={key:2,class:"error-message"};function Ll(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",Gs,[(0,l.Lk)("div",Zs,[t[14]||(t[14]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/counter"},{default:(0,l.k6)((()=>t[10]||(t[10]=[(0,l.eW)("🏠 回到管理主页")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/check-orders"},{default:(0,l.k6)((()=>t[11]||(t[11]=[(0,l.eW)("💵 查看订单及结账")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/manage-delivery"},{default:(0,l.k6)((()=>t[12]||(t[12]=[(0,l.eW)("🛵 外卖员管理")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[13]||(t[13]=[(0,l.eW)("🎟️ 分配优惠券")]))),_:1})])])]),(0,l.Lk)("div",el,[(0,l.Lk)("div",tl,[t[25]||(t[25]=(0,l.Lk)("h2",null,"🪑餐桌管理",-1)),(0,l.Lk)("div",al,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=e=>o.showDistribute=!0),class:(0,I.C4)({active:o.showDistribute})},"分配餐桌",2),(0,l.Lk)("button",{onClick:t[1]||(t[1]=e=>o.showDistribute=!1),class:(0,I.C4)({active:!o.showDistribute})},"释放餐桌",2)]),o.showDistribute?((0,l.uX)(),(0,l.CE)("div",sl,[t[21]||(t[21]=(0,l.Lk)("h3",null,"🍽️ 分配餐桌",-1)),(0,l.Lk)("div",ll,[t[15]||(t[15]=(0,l.Lk)("label",{for:"userId"},"用户 ID",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.userId=e),type:"number",placeholder:"请输入用户编号",required:""},null,512),[[s.Jo,o.userId]])]),(0,l.Lk)("div",rl,[t[18]||(t[18]=(0,l.Lk)("label",null,"选择桌型",-1)),(0,l.Lk)("div",ol,[(0,l.Lk)("label",null,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.tableType=e),type:"radio",value:"normal"},null,512),[[s.XL,o.tableType]]),t[16]||(t[16]=(0,l.eW)(" 普通桌位 "))]),(0,l.Lk)("label",null,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.tableType=e),type:"radio",value:"private"},null,512),[[s.XL,o.tableType]]),t[17]||(t[17]=(0,l.eW)(" 包厢 "))])])]),(0,l.Lk)("div",nl,[t[19]||(t[19]=(0,l.Lk)("label",{for:"numOfPeople"},"用餐人数",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>o.numOfPeople=e),type:"number",placeholder:"例如：4",required:""},null,512),[[s.Jo,o.numOfPeople]])]),(0,l.Lk)("div",il,[t[20]||(t[20]=(0,l.Lk)("label",{for:"reservationTime"},"用餐时间",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>o.reservationTime=e),type:"datetime-local",min:o.minTime,required:""},null,8,ul),[[s.Jo,o.reservationTime]])]),(0,l.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>n.submitReservation&&n.submitReservation(...e))},"确认分配"),o.successMessage?((0,l.uX)(),(0,l.CE)("div",cl,(0,I.v_)(o.successMessage),1)):(0,l.Q3)("",!0),o.errorMessage?((0,l.uX)(),(0,l.CE)("div",dl,(0,I.v_)(o.errorMessage),1)):(0,l.Q3)("",!0)])):((0,l.uX)(),(0,l.CE)("div",kl,[t[24]||(t[24]=(0,l.Lk)("h3",null,"释放餐桌",-1)),(0,l.Lk)("div",pl,[t[22]||(t[22]=(0,l.Lk)("label",{for:"userId"},"用户ID：",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>o.userId=e),type:"number",required:""},null,512),[[s.Jo,o.userId]])]),(0,l.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>n.releaseTable&&n.releaseTable(...e))},"确认释放"),o.successMessage?((0,l.uX)(),(0,l.CE)("div",hl,(0,I.v_)(o.successMessage),1)):(0,l.Q3)("",!0),o.releasedTables.length?((0,l.uX)(),(0,l.CE)("div",ml,[t[23]||(t[23]=(0,l.Lk)("div",null,"已释放的桌位号：",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.releasedTables,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,I.v_)(e),1)))),128))])])):(0,l.Q3)("",!0),o.errorMessage?((0,l.uX)(),(0,l.CE)("div",vl,(0,I.v_)(o.errorMessage),1)):(0,l.Q3)("",!0)]))])])])}var gl={data(){return{showDistribute:!0,userId:"",tableType:"normal",numOfPeople:"",reservationTime:"",minTime:"",successMessage:"",errorMessage:"",releasedTables:[]}},created(){const e=new Date,t=-e.getTimezoneOffset(),a=new Date(e.getTime()+6e4*t).toISOString().slice(0,16);this.minTime=a},methods:{async submitReservation(){this.successMessage="",this.errorMessage="";try{const e=await b.A.post("http://localhost:8080/api/table/distribute",{userId:this.userId,tableType:this.tableType,numOfPeople:this.numOfPeople,reservationTime:this.reservationTime});e.data.success?(this.successMessage=`餐桌分配成功！分配给用户ID：${this.userId}，桌号为：${e.data.tableNumber}`,setTimeout((()=>{this.$router.push("/counter")}),3e3)):this.errorMessage=e.data.message}catch(e){this.errorMessage="请求失败："+e.message}},async releaseTable(){this.successMessage="",this.errorMessage="",this.releasedTables=[];try{const e=await b.A.post("http://localhost:8080/api/table/relieve",{userId:this.userId});e.data.success?(this.successMessage=`餐桌释放成功！释放用户ID：${this.userId}`,this.releasedTables=e.data.releasedTables,setTimeout((()=>{this.$router.push("/counter")}),3e3)):this.errorMessage=e.data.message||"释放失败"}catch(e){this.errorMessage="请求失败："+e.message}}}};const bl=(0,i.A)(gl,[["render",Ll],["__scopeId","data-v-76e7c2e1"]]);var yl=bl;const fl={class:"container"},_l={class:"sidebar"},Cl={class:"content"},Il={class:"action-buttons"};function Pl(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",fl,[(0,l.Lk)("div",_l,[t[4]||(t[4]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/counter"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)(" 🏠 回到管理主页 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/check-orders"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)(" 💵 查看订单及结账 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)(" 🎟️ 分配优惠券 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)(" 🪑 餐桌预定 ")]))),_:1})])])]),(0,l.Lk)("div",Cl,[t[8]||(t[8]=(0,l.Lk)("h2",{class:"page-title"}," 📦 管理外卖订单 ",-1)),(0,l.Lk)("div",Il,[(0,l.bF)(n,{to:"/assign-delivery",class:"redirect-button"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)(" 🚚 分配外卖员 ")]))),_:1}),(0,l.bF)(n,{to:"/add-delivery-person",class:"redirect-button"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)(" ➕ 添加外卖员 ")]))),_:1}),(0,l.bF)(n,{to:"/view-delivery-orders",class:"redirect-button"},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)(" 📄 查看外卖订单 ")]))),_:1})])])])}var Wl={name:"ManageDelivery"};const Fl=(0,i.A)(Wl,[["render",Pl],["__scopeId","data-v-0c3ed075"]]);var Dl=Fl;const wl={class:"container"},El={class:"sidebar"},Xl={class:"content"},Al={key:0,class:"order-list"},Sl={class:"order-info"},Tl={class:"assign-form"},Ol=["onUpdate:modelValue"],$l=["value"],Ml=["onClick"],Nl={key:1,class:"no-orders"};function Vl(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",wl,[(0,l.Lk)("div",El,[t[4]||(t[4]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/counter"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)(" 🏠 回到管理主页 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/check-orders"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)(" 💵 查看订单及结账 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)(" 🎟️ 分配优惠券 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)(" 🪑 餐桌预定 ")]))),_:1})])])]),(0,l.Lk)("div",Xl,[t[12]||(t[12]=(0,l.Lk)("h2",{class:"page-title"}," 📦 分配外卖员 ",-1)),o.orders.length>0?((0,l.uX)(),(0,l.CE)("div",Al,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.orders,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.orderId,class:"order-card"},[(0,l.Lk)("div",Sl,[(0,l.Lk)("p",null,[t[5]||(t[5]=(0,l.Lk)("strong",null,"订单ID：",-1)),(0,l.eW)((0,I.v_)(e.orderId),1)]),(0,l.Lk)("p",null,[t[6]||(t[6]=(0,l.Lk)("strong",null,"送达地址：",-1)),(0,l.eW)((0,I.v_)(e.deliveryAddress),1)]),(0,l.Lk)("p",null,[t[7]||(t[7]=(0,l.Lk)("strong",null,"下单时间：",-1)),(0,l.eW)((0,I.v_)(e.timeOrdered),1)]),(0,l.Lk)("p",null,[t[8]||(t[8]=(0,l.Lk)("strong",null,"菜品：",-1)),(0,l.eW)((0,I.v_)(e.dishList),1)]),(0,l.Lk)("p",null,[t[9]||(t[9]=(0,l.Lk)("strong",null,"总价格：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.price),1)]),(0,l.Lk)("p",null,[t[10]||(t[10]=(0,l.Lk)("strong",null,"优惠金额：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.discountAmount),1)])]),(0,l.Lk)("div",Tl,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t=>o.selectedDeliveryPerson[e.orderId]=t},[t[11]||(t[11]=(0,l.Lk)("option",{disabled:"",value:""}," 请选择外卖员 ",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.deliveryPersons,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.deliveryPersonId,value:e.deliveryPersonId}," 外卖员"+(0,I.v_)(e.deliveryPersonId)+" - "+(0,I.v_)(e.name),9,$l)))),128))],8,Ol),[[s.u1,o.selectedDeliveryPerson[e.orderId]]]),(0,l.Lk)("button",{onClick:t=>n.assign(e.orderId)}," 🚚 分配 ",8,Ml)])])))),128))])):((0,l.uX)(),(0,l.CE)("div",Nl," 暂无待分配的外卖订单。 "))])])}var Ul={data(){return{orders:[],deliveryPersons:[],selectedDeliveryPerson:{}}},created(){this.fetchOrders(),this.fetchDeliveryPersons()},methods:{async fetchOrders(){try{const e=await b.A.get("http://localhost:8080/api/takeaway/pending-orders");this.orders=e.data||[]}catch(e){console.error("获取订单失败",e)}},async fetchDeliveryPersons(){try{const e=await b.A.get("http://localhost:8080/api/takeaway/available-delivery-persons");this.deliveryPersons=e.data||[]}catch(e){console.error("获取外卖员失败",e)}},async assign(e){const t=this.selectedDeliveryPerson[e];if(t)try{const a=await b.A.post("http://localhost:8080/api/takeaway/assign-delivery",{orderId:e,deliveryPersonId:t});a.data.success?(alert("分配外卖员成功！"),this.fetchOrders()):alert("分配失败："+a.data.message)}catch(a){console.error("分配失败",a),alert("分配请求失败："+a.message)}else alert("请选择要分配的外卖员")}}};const xl=(0,i.A)(Ul,[["render",Vl],["__scopeId","data-v-4986ab75"]]);var Jl=xl;const Kl={class:"container"},Rl={class:"sidebar"},ql={class:"content"},Ql={class:"form-group"},jl={class:"form-group"};function Hl(e,t,a,r,o,n){const i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",Kl,[(0,l.Lk)("div",Rl,[t[7]||(t[7]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/counter"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)(" 🏠 回到管理主页 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/check-orders"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)(" 💵 查看订单及结账 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)(" 🎟️ 分配优惠券 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(i,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)(" 🪑 餐桌预定 ")]))),_:1})])])]),(0,l.Lk)("div",ql,[t[11]||(t[11]=(0,l.Lk)("h2",{class:"page-title"}," ➕ 添加外卖员 ",-1)),(0,l.Lk)("form",{class:"form-card",onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>r.submitForm&&r.submitForm(...e)),["prevent"]))},[(0,l.Lk)("div",Ql,[t[8]||(t[8]=(0,l.Lk)("label",null,"姓名：",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.name=e),placeholder:"请输入外卖员姓名",required:""},null,512),[[s.Jo,r.form.name]])]),(0,l.Lk)("div",jl,[t[9]||(t[9]=(0,l.Lk)("label",null,"联系方式：",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.phoneNumber=e),placeholder:"请输入手机号",required:""},null,512),[[s.Jo,r.form.phoneNumber]])]),t[10]||(t[10]=(0,l.Lk)("button",{type:"submit"}," 提交 ",-1))],32),r.message?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,I.C4)([{success:r.success,error:!r.success},"message"])},(0,I.v_)(r.message),3)):(0,l.Q3)("",!0)])])}var Bl={name:"AddDeliveryPerson",setup(){const e=(0,g.KR)({name:"",phoneNumber:""}),t=(0,g.KR)(""),a=(0,g.KR)(!1),s=async()=>{try{const s=await b.A.post("http://localhost:8080/api/delivery/add",e.value);a.value=s.data.success,t.value=s.data.message,a.value&&(e.value.name="",e.value.phoneNumber="")}catch(s){a.value=!1,t.value="请求出错，请稍后重试"}};return{form:e,message:t,success:a,submitForm:s}}};const zl=(0,i.A)(Bl,[["render",Hl],["__scopeId","data-v-4b4dba07"]]);var Yl=zl;const Gl={class:"container"},Zl={class:"sidebar"},er={class:"order-container"},tr={key:0,class:"orders-list"},ar={class:"order-header"},sr={class:"order-info"},lr={class:"order-total"},rr={class:"order-details"},or={class:"payment-status"},nr={key:0},ir={key:1},ur={key:1};function cr(e,t,a,s,r,o){const n=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",Gl,[(0,l.Lk)("div",Zl,[t[5]||(t[5]=(0,l.Lk)("h3",null,"前台管理系统",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/counter"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)(" 🏠 回到管理主页 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/check-orders"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)(" 💵 查看订单及结账 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/distribute-coupons"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)(" 🎟️ 分配优惠券 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-delivery"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)(" 🛵 外卖员管理 ")]))),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(n,{to:"/manage-tables"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)(" 🪑 餐桌预定 ")]))),_:1})])])]),(0,l.Lk)("div",er,[t[16]||(t[16]=(0,l.Lk)("h2",{class:"page-title"}," 📦 所有外卖订单 ",-1)),r.orders.length?((0,l.uX)(),(0,l.CE)("div",tr,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.orders,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.orderId,class:"order-item"},[(0,l.Lk)("div",ar,[(0,l.Lk)("div",sr,[(0,l.Lk)("p",null,[t[6]||(t[6]=(0,l.Lk)("strong",null,"订单ID：",-1)),(0,l.eW)((0,I.v_)(e.orderId),1)]),(0,l.Lk)("p",null,[t[7]||(t[7]=(0,l.Lk)("strong",null,"用户ID：",-1)),(0,l.eW)((0,I.v_)(e.userId),1)]),(0,l.Lk)("p",null,[t[8]||(t[8]=(0,l.Lk)("strong",null,"送达地址：",-1)),(0,l.eW)((0,I.v_)(e.deliveryAddress),1)]),(0,l.Lk)("p",null,[t[9]||(t[9]=(0,l.Lk)("strong",null,"下单时间：",-1)),(0,l.eW)((0,I.v_)(o.formatDate(e.timeOrdered)),1)])]),(0,l.Lk)("div",lr,[(0,l.Lk)("p",null,[t[10]||(t[10]=(0,l.Lk)("strong",null,"总价格：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.price.toFixed(2)),1)])])]),(0,l.Lk)("div",rr,[(0,l.Lk)("p",null,[t[11]||(t[11]=(0,l.Lk)("strong",null,"菜品：",-1)),(0,l.eW)((0,I.v_)(e.dishList),1)])]),(0,l.Lk)("div",or,[(0,l.Lk)("p",null,[t[12]||(t[12]=(0,l.Lk)("strong",null,"配送状态：",-1)),(0,l.eW)((0,I.v_)(o.statusText(e.deliveryStatus)),1)]),e.discountAmount?((0,l.uX)(),(0,l.CE)("p",nr,[t[13]||(t[13]=(0,l.Lk)("strong",null,"优惠金额：",-1)),(0,l.eW)("￥"+(0,I.v_)(e.discountAmount),1)])):(0,l.Q3)("",!0),e.deliveryPersonId?((0,l.uX)(),(0,l.CE)("p",ir,[t[14]||(t[14]=(0,l.Lk)("strong",null,"外卖员ID：",-1)),(0,l.eW)((0,I.v_)(e.deliveryPersonId),1)])):(0,l.Q3)("",!0)])])))),128))])):((0,l.uX)(),(0,l.CE)("div",ur,t[15]||(t[15]=[(0,l.Lk)("p",null,"暂无外卖订单记录",-1)])))])])}var dr={data(){return{orders:[]}},created(){this.fetchOrders()},methods:{async fetchOrders(){try{const e=await b.A.get("http://localhost:8080/api/takeaway/all-orders");this.orders=e.data||[]}catch(e){console.error("获取外卖订单失败",e)}},formatDate(e){const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},statusText(e){const t={pending:"待分配",delivering:"配送中",delivered:"已送达"};return t[e]||"未知"}}};const kr=(0,i.A)(dr,[["render",cr],["__scopeId","data-v-01097c47"]]);var pr=kr;const hr=[{path:"/",redirect:"/login"},{path:"/register",component:C},{path:"/login",component:L},{path:"/menu",component:M},{path:"/package",component:B},{path:"/buffet",component:ce},{path:"/checkout",component:Ke},{path:"/my-account",component:tt},{path:"/ordertable",component:ye},{path:"/my_ordertable",component:Xe},{path:"/orders",component:ft},{path:"/coupon",component:Tt},{path:"/admin",component:Zt},{path:"/reviews",component:ba},{path:"/counter",component:Wa},{path:"/check-orders",component:Qa},{path:"/distribute-coupons",component:ls},{path:"/exchange",component:vs},{path:"/delivery-checkout",component:Fs},{path:"/takeaway-order",component:Ys},{path:"/manage-tables",component:yl},{path:"/manage-delivery",component:Dl},{path:"/assign-delivery",component:Jl},{path:"/add-delivery-person",component:Yl},{path:"/view-delivery-orders",component:pr}];var mr=(0,d.aE)({history:(0,d.LA)(),routes:hr});(0,s.Ef)(c).use(mr).mount("#app")}},t={};function a(s){var l=t[s];if(void 0!==l)return l.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,s,l,r){if(!s){var o=1/0;for(c=0;c<e.length;c++){s=e[c][0],l=e[c][1],r=e[c][2];for(var n=!0,i=0;i<s.length;i++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](s[i])}))?s.splice(i--,1):(n=!1,r<o&&(o=r));if(n){e.splice(c--,1);var u=l();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[s,l,r]}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var l,r,o=s[0],n=s[1],i=s[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(l in n)a.o(n,l)&&(a.m[l]=n[l]);if(i)var c=i(a)}for(t&&t(s);u<o.length;u++)r=o[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(c)},s=self["webpackChunkorder_dish_frontend"]=self["webpackChunkorder_dish_frontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(8424)}));s=a.O(s)})();
//# sourceMappingURL=app.5f349302.js.map